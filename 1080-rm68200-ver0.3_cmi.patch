From f231e4a91ab160c378bf9a1d2128bda673e6e21c Mon Sep 17 00:00:00 2001
From: olegsvs <oleg.texet@gmail.com>
Date: Mon, 9 May 2016 22:08:32 +0300
Subject: [PATCH 1080/1168] rm68200 ver0.3_cmi

---
 .../rm68200_6735_dsi_video.c                       | 383 +++++++++++----------
 include/generated/compile.h                        |   4 +-
 2 files changed, 194 insertions(+), 193 deletions(-)

diff --git a/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c b/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
index 48e950a..a41ea0a 100644
--- a/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
+++ b/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
@@ -112,6 +112,10 @@
 #endif
 
 
+// ---------------------------------------------------------------------------
+//  Local Variables
+// ---------------------------------------------------------------------------
+
 static LCM_UTIL_FUNCS lcm_util = {0};
 
 #define SET_RESET_PIN(v)    								(lcm_util.set_reset_pin((v)))
@@ -142,42 +146,52 @@ static unsigned int lcm_esd_test = FALSE;      ///only for ESD test
 
 
 static struct LCM_setting_table lcm_initialization_setting[] = {
-	
-{0xFE, 1,{0x01}},
 
-{0x00, 1,{0x0A}},
+	/*
+Note :
 
-{0x03, 1,{0x1A}},
+Data ID will depends on the following rule.
 
-{0x04, 1,{0x24}},
+count of parameters > 1      => Data ID = 0x39
+count of parameters = 1      => Data ID = 0x15
+count of parameters = 0      => Data ID = 0x05
 
-{0x05, 1,{0x05}},
+Struclcm_deep_sleep_mode_in_settingture Format :
 
-{0x06, 1,{0x0C}},
+{DCS command, count of parameters, {parameter list}}
+{REGFLAG_DELAY, milliseconds of time, {}},
 
-{0x24, 1,{0xC0}},
+...
 
-{0x25, 1,{0x53}},
+Setting ending by predefined flag
 
-{0x26, 1,{0x00}},
+{REGFLAG_END_OF_TABLE, 0x00, {}}
+*/
 
-{0x27, 1,{0x0A}},
+/**************************************************
+IC Name: RM68200
+Panel Maker/Size: INL499
+Panel Product No.: F050A13-603
+Version: V0
+Date: 20140819
+**************************************************/
 
-{0x29, 1,{0x0A}},
 
-{0x2B, 1,{0xE5}},
+{0xFE, 1,{0x01}},
 
-{0x16, 1,{0x52}},
+{0x00, 1,{0x0A}},
+
+{0x01, 1,{0x08}},
 
-{0x27, 1,{0x0D}},
+{0x2B, 1,{0xC5}},
 
-{0x28, 1,{0x0D}},
+{0x16, 1,{0x52}},
 
-{0x29, 1,{0x0D}},
+{0x27, 1,{0x0C}},
 
-{0x2A, 1,{0x0D}},
+{0x29, 1,{0x0C}},
 
-{0x2F, 1,{0x55}},
+{0x2F, 1,{0x6A}},
 
 {0x34, 1,{0x55}},
 
@@ -187,13 +201,13 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x1A, 1,{0x06}},
 
-{0x46, 1,{0x46}},
+{0x46, 1,{0x5A}},
 
-{0x52, 1,{0x8D}},
+{0x52, 1,{0x95}},
 
 {0x53, 1,{0x00}},
 
-{0x54, 1,{0x8D}},
+{0x54, 1,{0x95}},
 
 {0x55, 1,{0x00}},
 
@@ -202,109 +216,105 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x00, 1,{0x05}},
 
-{0x01, 1,{0x14}},
+{0x01, 1,{0x16}},
 
-{0x02, 1,{0x06}},
+{0x02, 1,{0x01}},
 
-{0x03, 1,{0x00}},
+{0x03, 1,{0x04}},
 
 {0x04, 1,{0x00}},
 
 {0x05, 1,{0x00}},
 
-{0x06, 1,{0x00}},
+{0x06, 1,{0x50}},
 
 {0x07, 1,{0x05}},
 
-{0x08, 1,{0x14}},
+{0x08, 1,{0x16}},
 
-{0x09, 1,{0x06}},
+{0x09, 1,{0x01}},
 
-{0x0A, 1,{0x00}},
+{0x0A, 1,{0x08}},
 
 {0x0B, 1,{0x00}},
 
 {0x0C, 1,{0x00}},
 
-{0x0D, 1,{0x00}},
+{0x0D, 1,{0x50}},
 
-{0x0E, 1,{0x09}},
+{0x0E, 1,{0x03}},
 
-{0x0F, 1,{0x08}},
+{0x0F, 1,{0x04}},
 
-{0x10, 1,{0x0B}},
+{0x10, 1,{0x05}},
 
-{0x11, 1,{0x0A}},
+{0x11, 1,{0x06}},
 
 {0x12, 1,{0x00}},
 
-{0x13, 1,{0x00}},
+{0x13, 1,{0x40}},
 
 {0x14, 1,{0x00}},
 
 {0x15, 1,{0xC5}},
 
-{0x16, 1,{0x08}},
+{0x16, 1,{0x0C}},
 
-{0x17, 1,{0x0D}},
+{0x17, 1,{0x07}},
 
-{0x18, 1,{0x0C}},
+{0x18, 1,{0x08}},
 
-{0x19, 1,{0x0F}},
+{0x19, 1,{0x09}},
 
-{0x1A, 1,{0x0E}},
+{0x1A, 1,{0x0A}},
 
 {0x1B, 1,{0x00}},
 
-{0x1C, 1,{0x00}},
+{0x1C, 1,{0x40}},
 
 {0x1D, 1,{0x00}},
 
 {0x1E, 1,{0x85}},
 
-{0x1F, 1,{0x08}},
+{0x1F, 1,{0x0C}},
 
 {0x20, 1,{0x00}},
 
 {0x21, 1,{0x00}},
 
-{0x22, 1,{0x08}},
+{0x22, 1,{0x03}},
 
-{0x23, 1,{0x1D}},
+{0x23, 1,{0x0A}},
 
-{0x24, 1,{0x12}},
+{0x24, 1,{0x0C}},
 
 {0x25, 1,{0x2D}},
 
 {0x26, 1,{0x00}},
 
-{0x27, 1,{0x1D}},
+{0x27, 1,{0x0E}},
 
-{0x28, 1,{0x16}},
+{0x28, 1,{0x10}},
 
 {0x29, 1,{0x2D}},
 
-{0x2A, 1,{0x00}},
-
-{0x2B, 1,{0x00}},
-
-{0x2C, 1,{0x00}},
+{0x2A, 1,{0x0B}},
 
-{0x2D, 1,{0x00}},
+{0x2B, 1,{0x0C}},
 
-{0x2E, 1,{0x00}},
+{0x2D, 1,{0x0D}},
 
-{0x2F, 1,{0x00}},
+{0x2F, 1,{0x0E}},
 
 {0x30, 1,{0x00}},
 
-{0x31, 1,{0x00}},
+{0x31, 1,{0x40}},
 
-{0x32, 1,{0x00}},
+{0x32, 1,{0x05}},
 
-{0x33, 1,{0x00}},
+{0x33, 1,{0x0C}},
 
-{0x34, 1,{0x00}},
+{0x34, 1,{0x40}},
 
 {0x35, 1,{0x00}},
 
@@ -320,12 +330,8 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x3B, 1,{0x00}},
 
-{0x3C, 1,{0x00}},
-
 {0x3D, 1,{0x00}},
 
-{0x3E, 1,{0x00}},
-
 {0x3F, 1,{0x00}},
 
 {0x40, 1,{0x00}},
@@ -374,8 +380,6 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x56, 1,{0x00}},
 
-{0x57, 1,{0x00}},
-
 {0x58, 1,{0x00}},
 
 {0x59, 1,{0x00}},
@@ -392,21 +396,21 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x5F, 1,{0x00}},
 
-{0x60, 1,{0x00}},
+{0x60, 1,{0x0B}},
 
 {0x61, 1,{0x00}},
 
-{0x62, 1,{0x00}},
+{0x62, 1,{0x80}},
 
-{0x63, 1,{0x00}},
+{0x63, 1,{0x12}},
 
-{0x64, 1,{0x00}},
+{0x64, 1,{0x14}},
 
 {0x65, 1,{0x00}},
 
 {0x66, 1,{0x00}},
 
-{0x67, 1,{0x00}},
+{0x67, 1,{0x55}},
 
 {0x68, 1,{0x00}},
 
@@ -418,7 +422,7 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x6C, 1,{0x00}},
 
-{0x6D, 1,{0x00}},
+{0x6D, 1,{0xBC}},
 
 {0x6E, 1,{0x00}},
 
@@ -426,23 +430,23 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x70, 1,{0x00}},
 
-{0x71, 1,{0x00}},
+{0x71, 1,{0x80}},
 
 {0x72, 1,{0x00}},
 
 {0x73, 1,{0x00}},
 
-{0x74, 1,{0x00}},
+{0x74, 1,{0x01}},
 
-{0x75, 1,{0x00}},
+{0x75, 1,{0x01}},
 
-{0x76, 1,{0x00}},
+{0x76, 1,{0x01}},
 
-{0x77, 1,{0x00}},
+{0x77, 1,{0x01}},
 
-{0x78, 1,{0x00}},
+{0x78, 1,{0x01}},
 
-{0x79, 1,{0x00}},
+{0x79, 1,{0x01}},
 
 {0x7A, 1,{0x00}},
 
@@ -452,204 +456,197 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x7D, 1,{0x00}},
 
-{0x7E, 1,{0x08}},
+{0x7E, 1,{0x18}},
 
-{0x7F, 1,{0x0A}},
+{0x7F, 1,{0x19}},
 
-{0x80, 1,{0x0C}},
+{0x80, 1,{0x09}},
 
-{0x81, 1,{0x0E}},
+{0x81, 1,{0x0B}},
 
-{0x82, 1,{0x00}},
+{0x82, 1,{0x0D}},
 
-{0x83, 1,{0x02}},
+{0x83, 1,{0x0F}},
 
-{0x84, 1,{0x3F}},
+{0x84, 1,{0x11}},
 
-{0x85, 1,{0x3F}},
+{0x85, 1,{0x13}},
 
-{0x86, 1,{0x3F}},
+{0x86, 1,{0x03}},
 
 {0x87, 1,{0x3F}},
 
-{0x88, 1,{0x3F}},
+{0x88, 1,{0x07}},
 
 {0x89, 1,{0x3F}},
 
-{0x8A, 1,{0x3F}},
+{0x8A, 1,{0x1C}},
 
 {0x8B, 1,{0x3F}},
 
 {0x8C, 1,{0x3F}},
 
-{0x8D, 1,{0x3F}},
+{0x8D, 1,{0x1C}},
 
-{0x8E, 1,{0x3F}},
+{0x8E, 1,{0x1C}},
 
-{0x8F, 1,{0x3F}},
+{0x8F, 1,{0x1C}},
 
 {0x90, 1,{0x3F}},
 
-{0x91, 1,{0x3F}},
+{0x91, 1,{0x01}},
 
-{0x92, 1,{0x1D}},
+{0x92, 1,{0x3F}},
 
-{0x93, 1,{0x1C}},
+{0x93, 1,{0x3F}},
 
-{0x94, 1,{0x1C}},
+{0x94, 1,{0x3F}},
 
-{0x95, 1,{0x1D}},
+{0x95, 1,{0x3F}},
 
-{0x96, 1,{0x3F}},
+{0x96, 1,{0x00}},
 
 {0x97, 1,{0x3F}},
 
-{0x98, 1,{0x3F}},
+{0x98, 1,{0x1C}},
 
-{0x99, 1,{0x3F}},
+{0x99, 1,{0x1C}},
 
-{0x9A, 1,{0x3F}},
+{0x9A, 1,{0x1C}},
 
 {0x9B, 1,{0x3F}},
 
 {0x9C, 1,{0x3F}},
 
-{0x9D, 1,{0x3F}},
+{0x9D, 1,{0x1C}},
 
 {0x9E, 1,{0x3F}},
 
-{0x9F, 1,{0x3F}},
+{0x9F, 1,{0x06}},
 
 {0xA0, 1,{0x3F}},
 
-{0xA2, 1,{0x3F}},
+{0xA2, 1,{0x02}},
 
-{0xA3, 1,{0x3F}},
+{0xA3, 1,{0x12}},
 
-{0xA4, 1,{0x3F}},
+{0xA4, 1,{0x10}},
 
-{0xA5, 1,{0x03}},
+{0xA5, 1,{0x0E}},
 
-{0xA6, 1,{0x01}},
+{0xA6, 1,{0x0C}},
 
-{0xA7, 1,{0x0F}},
+{0xA7, 1,{0x0A}},
 
-{0xA9, 1,{0x0D}},
+{0xA9, 1,{0x08}},
 
-{0xAA, 1,{0x0B}},
+{0xAA, 1,{0x19}},
 
-{0xAB, 1,{0x09}},
+{0xAB, 1,{0x18}},
 
-{0xAC, 1,{0x0F}},
+{0xAC, 1,{0x18}},
 
-{0xAD, 1,{0x0D}},
+{0xAD, 1,{0x19}},
 
-{0xAE, 1,{0x0B}},
+{0xAE, 1,{0x12}},
 
-{0xAF, 1,{0x09}},
+{0xAF, 1,{0x10}},
 
-{0xB0, 1,{0x03}},
+{0xB0, 1,{0x0E}},
 
-{0xB1, 1,{0x01}},
+{0xB1, 1,{0x0C}},
 
-{0xB2, 1,{0x3F}},
+{0xB2, 1,{0x0A}},
 
-{0xB3, 1,{0x3F}},
+{0xB3, 1,{0x08}},
 
-{0xB4, 1,{0x3F}},
+{0xB4, 1,{0x00}},
 
 {0xB5, 1,{0x3F}},
 
-{0xB6, 1,{0x3F}},
+{0xB6, 1,{0x06}},
 
 {0xB7, 1,{0x3F}},
 
-{0xB8, 1,{0x3F}},
+{0xB8, 1,{0x1C}},
 
 {0xB9, 1,{0x3F}},
 
 {0xBA, 1,{0x3F}},
 
-{0xBB, 1,{0x3F}},
+{0xBB, 1,{0x1C}},
 
-{0xBC, 1,{0x3F}},
+{0xBC, 1,{0x1C}},
 
-{0xBD, 1,{0x3F}},
+{0xBD, 1,{0x1C}},
 
 {0xBE, 1,{0x3F}},
 
-{0xBF, 1,{0x00}},
+{0xBF, 1,{0x02}},
 
-{0xC0, 1,{0x1C}},
+{0xC0, 1,{0x3F}},
 
-{0xC1, 1,{0x1D}},
+{0xC1, 1,{0x3F}},
 
-{0xC2, 1,{0x1D}},
+{0xC2, 1,{0x3F}},
 
-{0xC3, 1,{0x1C}},
+{0xC3, 1,{0x3F}},
 
-{0xC4, 1,{0x01}},
+{0xC4, 1,{0x03}},
 
 {0xC5, 1,{0x3F}},
 
-{0xC6, 1,{0x3F}},
+{0xC6, 1,{0x1C}},
 
-{0xC7, 1,{0x3F}},
+{0xC7, 1,{0x1C}},
 
-{0xC8, 1,{0x3F}},
+{0xC8, 1,{0x1C}},
 
 {0xC9, 1,{0x3F}},
 
 {0xCA, 1,{0x3F}},
 
-{0xCB, 1,{0x3F}},
+{0xCB, 1,{0x1C}},
 
 {0xCC, 1,{0x3F}},
 
-{0xCD, 1,{0x3F}},
+{0xCD, 1,{0x07}},
 
 {0xCE, 1,{0x3F}},
 
-{0xCF, 1,{0x3F}},
-
-{0xD0, 1,{0x3F}},
+{0xCF, 1,{0x01}},
 
-{0xD1, 1,{0x3F}},
+{0xD0, 1,{0x09}},
 
-{0xD2, 1,{0x00}},
+{0xD1, 1,{0x0B}},
 
-{0xD3, 1,{0x02}},
+{0xD2, 1,{0x0D}},
 
-{0xD4, 1,{0x08}},
+{0xD3, 1,{0x0F}},
 
-{0xD5, 1,{0x0A}},
+{0xD4, 1,{0x11}},
 
-{0xD6, 1,{0x0C}},
+{0xD5, 1,{0x13}},
 
-{0xD7, 1,{0x0E}},
+{0xD6, 1,{0x19}},
 
-{0xDC, 1,{0x02}},
+{0xD7, 1,{0x18}},
 
-{0xDE, 1,{0x13}},
-
-
-{0xFE, 1,{0x0E}},
-
-{0x01, 1,{0x75}},
+{0xDF, 1,{0x00}},
 
 {0xFE, 1,{0x04}},
 
 {0x60, 1,{0x00}},
 
-{0x61, 1,{0x07}},
+{0x61, 1,{0x10}},
 
-{0x62, 1,{0x0C}},
+{0x62, 1,{0x16}},
 
-{0x63, 1,{0x0D}},
+{0x63, 1,{0x0F}},
 
-{0x64, 1,{0x05}},
+{0x64, 1,{0x06}},
 
-{0x65, 1,{0x10}},
+{0x65, 1,{0x13}},
 
 {0x66, 1,{0x0F}},
 
@@ -659,29 +656,29 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x69, 1,{0x0C}},
 
-{0x6A, 1,{0x12}},
+{0x6A, 1,{0x10}},
 
-{0x6B, 1,{0x09}},
+{0x6B, 1,{0x07}},
 
-	{0x6C, 1,{0x0F}},
+{0x6C, 1,{0x0F}},
 
-	{0x6D, 1,{0x18}},
+{0x6D, 1,{0x15}},
 
-	{0x6E, 1,{0x12}},
+{0x6E, 1,{0x0F}},
 
 {0x6F, 1,{0x00}},
 
 {0x70, 1,{0x00}},
 
-{0x71, 1,{0x07}},
+{0x71, 1,{0x10}},
 
-{0x72, 1,{0x0C}},
+{0x72, 1,{0x16}},
 
-{0x73, 1,{0x0D}},
+{0x73, 1,{0x0F}},
 
-{0x74, 1,{0x05}},
+{0x74, 1,{0x06}},
 
-{0x75, 1,{0x10}},
+{0x75, 1,{0x13}},
 
 {0x76, 1,{0x0F}},
 
@@ -691,39 +688,45 @@ static struct LCM_setting_table lcm_initialization_setting[] = {
 
 {0x79, 1,{0x0C}},
 
-{0x7A, 1,{0x12}},
+{0x7A, 1,{0x10}},
 
-{0x7B, 1,{0x09}},
+{0x7B, 1,{0x07}},
 
-	{0x7C, 1,{0x0F}},
+{0x7C, 1,{0x0F}},
 
-	{0x7D, 1,{0x18}},
+{0x7D, 1,{0x15}},
 
-	{0x7E, 1,{0x12}},
+{0x7E, 1,{0x0F}},
 
 {0x7F, 1,{0x00}},
 
+{0xFE, 1,{0x00}},
 
-{0xFE, 1,{0x0B}},
+{0x58, 1,{0xA9}},
 
-{0x21, 1,{0x50}},
+{REGFLAG_DELAY, 120, {}},
 
-{0x22, 1,{0x50}},
+{0x11, 0,{0x00}},
 
+{REGFLAG_DELAY, 100, {}},
 
-{0xFE, 1,{0x00}},
+{0x29, 0,{0x00}},
+{REGFLAG_DELAY, 100, {}},
 
-	{0x58, 1,{0xAD}},
-{0x35, 0,{0x00}},
+{REGFLAG_END_OF_TABLE, 0x00, {}}
+};
 
-{0x11, 0,{0x00}},
 
-{REGFLAG_DELAY, 120, {}},
+static struct LCM_setting_table lcm_sleep_out_setting[] = {
+	// Sleep Out
+	{0x11, 1, {0x00}},
+	{REGFLAG_DELAY, 120, {}},
 
-{0x29, 0,{0x00}},
+	// Display ON
+	{0x29, 1, {0x00}},
+	{REGFLAG_DELAY, 10, {}},
 
-{REGFLAG_DELAY, 100, {}},
-{REGFLAG_END_OF_TABLE, 0x00, {}}
+	{REGFLAG_END_OF_TABLE, 0x00, {}}
 };
 
 
@@ -822,14 +825,14 @@ static void lcm_get_params(LCM_PARAMS * params)
 	// Video mode setting
 	params->dsi.packet_size=256;
 
-	params->dsi.vertical_sync_active				=  2;//2
+	params->dsi.vertical_sync_active				=  4;//2
 	params->dsi.vertical_backporch					= 14;//50;
 	params->dsi.vertical_frontporch					= 16;//50;
 	params->dsi.vertical_active_line				= FRAME_HEIGHT; 
 
-	params->dsi.horizontal_sync_active				= 8;//10
-	params->dsi.horizontal_backporch				= 40;//34; 
-	params->dsi.horizontal_frontporch				= 40;//24;
+	params->dsi.horizontal_sync_active				= 10;//10
+	params->dsi.horizontal_backporch				= 34;//34; 
+	params->dsi.horizontal_frontporch				= 24;//24;
 	params->dsi.horizontal_active_pixel				= FRAME_WIDTH;
 
 	// Bit rate calculation
@@ -958,7 +961,6 @@ static unsigned int lcm_compare_id(void)
 		printk("rm68200a %s id1 = 0x%04x, id2 = 0x%04x\n", __func__, id1,id2);
 	#endif
 	return (0x6820 == id1)?1:0;
-
 }
 //no use
 static unsigned int lcm_esd_recover(void)
@@ -1022,7 +1024,6 @@ static unsigned int lcm_esd_check(void)
         }
 #endif
 }
-
 // ---------------------------------------------------------------------------
 //  Get LCM Driver Hooks
 // ---------------------------------------------------------------------------
diff --git a/include/generated/compile.h b/include/generated/compile.h
index ffdec2a..5327622 100644
--- a/include/generated/compile.h
+++ b/include/generated/compile.h
@@ -1,7 +1,7 @@
-/* This file is auto generated, version 8 */
+/* This file is auto generated, version 9 */
 /* SMP PREEMPT */
 #define UTS_MACHINE "arm64"
-#define UTS_VERSION "#8 SMP PREEMPT Mon May 9 22:05:22 MSK 2016"
+#define UTS_VERSION "#9 SMP PREEMPT Mon May 9 22:07:12 MSK 2016"
 #define LINUX_COMPILE_BY "olegsvs"
 #define LINUX_COMPILE_HOST "olegsvs-develop"
 #define LINUX_COMPILER "gcc version 4.9 20150123 (prerelease) (GCC) "
-- 
2.7.4

