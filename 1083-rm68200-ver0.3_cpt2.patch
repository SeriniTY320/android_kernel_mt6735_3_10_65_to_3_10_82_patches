From b45dd909240ca3710aba31cde56024494ac7922e Mon Sep 17 00:00:00 2001
From: olegsvs <oleg.texet@gmail.com>
Date: Mon, 9 May 2016 22:14:23 +0300
Subject: [PATCH 1083/1168] rm68200 ver0.3_cpt2

---
 .../rm68200_6735_dsi_video.c                       | 1060 ++++++++------------
 include/generated/compile.h                        |    4 +-
 2 files changed, 396 insertions(+), 668 deletions(-)

diff --git a/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c b/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
index 7a37c40..ac3e6af 100644
--- a/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
+++ b/drivers/misc/mediatek/lcm/rm68200_6735_dsi_video/rm68200_6735_dsi_video.c
@@ -67,28 +67,21 @@
 *  THE RULES OF THE INTERNATIONAL CHAMBER OF COMMERCE (ICC).
 *
 *****************************************************************************/
-
-
-#ifdef BUILD_LK
-#else
+#ifndef BUILD_LK
 #include <linux/string.h>
-#if defined(BUILD_UBOOT)
-#include <asm/arch/mt_gpio.h>
-#else
-#include <mach/mt_gpio.h>
 #endif
-#endif
-#include "lcm_drv.h"
 
-#define test "rm68200 ver0.3"
+#include "lcm_drv.h"
 
-#if defined(BUILD_LK)
+#ifdef BUILD_LK
+	#include <platform/mt_gpio.h>
+	#include <string.h>
+#elif defined(BUILD_UBOOT)
+	#include <asm/arch/mt_gpio.h>
 #else
-
-#include <linux/proc_fs.h>   //proc file use 
+//	#include <mach/mt_gpio.h>
 #endif
 
-
 // ---------------------------------------------------------------------------
 //  Local Constants
 // ---------------------------------------------------------------------------
@@ -97,8 +90,8 @@
 #define FRAME_HEIGHT 										(1280)
 #define LCM_ID                       						(0x1284)
 
-#define REGFLAG_DELAY             							(0XEE)
-#define REGFLAG_END_OF_TABLE      							(0xDD00)	// END OF REGISTERS MARKER
+#define REGFLAG_DELAY             							(0XFFFE)
+#define REGFLAG_END_OF_TABLE      							(0xFFFF)	// END OF REGISTERS MARKER
 
 
 #define LCM_DSI_CMD_MODE									0
@@ -111,8 +104,6 @@
     #define FALSE 0
 #endif
 
-
-
 // ---------------------------------------------------------------------------
 //  Local Variables
 // ---------------------------------------------------------------------------
@@ -124,7 +115,7 @@ static LCM_UTIL_FUNCS lcm_util = {0};
 #define UDELAY(n) 											(lcm_util.udelay(n))
 #define MDELAY(n) 											(lcm_util.mdelay(n))
 
-#define LCM_RM68200_ID 		(0x8200)
+#define LCM_RM68200_ID 		(0x6820)
 
 static unsigned int lcm_esd_test = FALSE;      ///only for ESD test
 
@@ -168,574 +159,295 @@ Setting ending by predefined flag
 
 {REGFLAG_END_OF_TABLE, 0x00, {}}
 */
-
-/**************************************************
-IC Name: F056A4
-Panel Maker/Size: AUO546
-Panel Product No.: H546TAN01
-Version: V0
-Date: 20140618_PFM
-**************************************************/
-{0xFE, 1,{0x01}},
-
-//{0x01, 1,{0x12}},
-
-{0x24, 1,{0xC0}},
-
-{0x25, 1,{0x53}},
-
-{0x26, 1,{0x00}},
-
-{0x27, 1,{0x0A}},
-
-{0x29, 1,{0x0A}},
-
-{0x2B, 1,{0xE5}},
-
-{0x16, 1,{0x52}},
-
-{0x2F, 1,{0x5A}},
-
-{0x34, 1,{0x57}},
-
-{0x1B, 1,{0x00}},
-
-{0x12, 1,{0x0B}},
-
-{0x1A, 1,{0x06}},
-
-{0x46, 1,{0x4C}},  //VCOM 4f //5A
-
-{0x52, 1,{0x6C}},
-
-{0x53, 1,{0x00}},
-
-{0x54, 1,{0x6C}},
-
-{0x55, 1,{0x00}},
-
-{0xFE, 1,{0x03}},
-
-{0x00, 1,{0x05}},
-
-{0x01, 1,{0x16}},
-
-{0x02, 1,{0x09}},
-
-{0x03, 1,{0x0D}},
-
-{0x04, 1,{0x00}},
-
-{0x05, 1,{0x00}},
-
-{0x06, 1,{0x50}},
-
-{0x07, 1,{0x05}},
-
-{0x08, 1,{0x16}},
-
-{0x09, 1,{0x0B}},
-
-{0x0A, 1,{0x0F}},
-
-{0x0B, 1,{0x00}},
-
-{0x0C, 1,{0x00}},
-
-{0x0D, 1,{0x50}},
-
-{0x0E, 1,{0x03}},
-
-{0x0F, 1,{0x04}},
-
-{0x10, 1,{0x05}},
-
-{0x11, 1,{0x06}},
-
-{0x12, 1,{0x00}},
-
-{0x13, 1,{0x54}},
-
-{0x14, 1,{0x00}},
-
-{0x15, 1,{0xC5}},
-
-{0x16, 1,{0x08}},
-
-{0x17, 1,{0x07}},
-
-{0x18, 1,{0x08}},
-
-{0x19, 1,{0x09}},
-
-{0x1A, 1,{0x0A}},
-
-{0x1B, 1,{0x00}},
-
-{0x1C, 1,{0x54}},
-
-{0x1D, 1,{0x00}},
-
-{0x1E, 1,{0x85}},
-
-{0x1F, 1,{0x08}},
-
-{0x20, 1,{0x00}},
-
-{0x21, 1,{0x00}},
-
-{0x22, 1,{0x03}},
-
-{0x23, 1,{0x1F}},
-
-{0x24, 1,{0x00}},
-
-{0x25, 1,{0x28}},
-
-{0x26, 1,{0x00}},
-
-{0x27, 1,{0x1F}},
-
-{0x28, 1,{0x00}},
-
-{0x29, 1,{0x28}},
-
-{0x2A, 1,{0x00}},
-
-{0x2B, 1,{0x00}},
-
-{0x2D, 1,{0x00}},
-
-{0x2F, 1,{0x00}},
-
-{0x30, 1,{0x00}},
-
-{0x31, 1,{0x00}},
-
-{0x32, 1,{0x00}},
-
-{0x33, 1,{0x00}},
-
-{0x34, 1,{0x00}},
-
-{0x35, 1,{0x00}},
-
-{0x36, 1,{0x00}},
-
-{0x37, 1,{0x00}},
-
-{0x38, 1,{0x00}},
-
-{0x39, 1,{0x00}},
-
-{0x3A, 1,{0x00}},
-
-{0x3B, 1,{0x00}},
-
-{0x3D, 1,{0x00}},
-
-{0x3F, 1,{0x00}},
-
-{0x40, 1,{0x00}},
-
-{0x3F, 1,{0x00}},
-
-{0x41, 1,{0x00}},
-
-{0x42, 1,{0x00}},
-
-{0x43, 1,{0x00}},
-
-{0x44, 1,{0x00}},
-
-{0x45, 1,{0x00}},
-
-{0x46, 1,{0x00}},
-
-{0x47, 1,{0x00}},
-
-{0x48, 1,{0x00}},
-
-{0x49, 1,{0x00}},
-
-{0x4A, 1,{0x00}},
-
-{0x4B, 1,{0x00}},
-
-{0x4C, 1,{0x00}},
-
-{0x4D, 1,{0x00}},
-
-{0x4E, 1,{0x00}},
-
-{0x4F, 1,{0x00}},
-
-{0x50, 1,{0x00}},
-
-{0x51, 1,{0x00}},
-
-{0x52, 1,{0x00}},
-
-{0x53, 1,{0x00}},
-
-{0x54, 1,{0x00}},
-
-{0x55, 1,{0x00}},
-
-{0x56, 1,{0x00}},
-
-{0x58, 1,{0x00}},
-
-{0x59, 1,{0x00}},
-
-{0x5A, 1,{0x00}},
-
-{0x5B, 1,{0x00}},
-
-{0x5C, 1,{0x00}},
-
-{0x5D, 1,{0x00}},
-
-{0x5E, 1,{0x00}},
-
-{0x5F, 1,{0x00}},
-
-{0x60, 1,{0x00}},
-
-{0x61, 1,{0x00}},
-
-{0x62, 1,{0x00}},
-
-{0x63, 1,{0x00}},
-
-{0x64, 1,{0x00}},
-
-{0x65, 1,{0x00}},
-
-{0x66, 1,{0x00}},
-
-{0x67, 1,{0x00}},
-
-{0x68, 1,{0x00}},
-
-{0x69, 1,{0x00}},
-
-{0x6A, 1,{0x00}},
-
-{0x6B, 1,{0x00}},
-
-{0x6C, 1,{0x00}},
-
-{0x6D, 1,{0x00}},
-
-{0x6E, 1,{0x00}},
-
-{0x6F, 1,{0x00}},
-
-{0x70, 1,{0x00}},
-
-{0x71, 1,{0x00}},
-
-{0x72, 1,{0x00}},
-
-{0x73, 1,{0x00}},
-
-{0x74, 1,{0x04}},
-
-{0x75, 1,{0x04}},
-
-{0x76, 1,{0x04}},
-
-{0x77, 1,{0x04}},
-
-{0x78, 1,{0x00}},
-
-{0x79, 1,{0x00}},
-
-{0x7A, 1,{0x00}},
-
-{0x7B, 1,{0x00}},
-
-{0x7C, 1,{0x00}},
-
-{0x7D, 1,{0x00}},
-
-{0x7E, 1,{0x86}},
-
-{0x7F, 1,{0x02}},
-
-{0x80, 1,{0x0E}},
-
-{0x81, 1,{0x0C}},
-
-{0x82, 1,{0x0A}},
-
-{0x83, 1,{0x08}},
-
-{0x84, 1,{0x3F}},
-
-{0x85, 1,{0x3F}},
-
-{0x86, 1,{0x3F}},
-
-{0x87, 1,{0x3F}},
-
-{0x88, 1,{0x3F}},
-
-{0x89, 1,{0x3F}},
-
-{0x8A, 1,{0x3F}},
-
-{0x8B, 1,{0x3F}},
-
-{0x8C, 1,{0x3F}},
-
-{0x8D, 1,{0x3F}},
-
-{0x8E, 1,{0x3F}},
-
-{0x8F, 1,{0x3F}},
-
-{0x90, 1,{0x00}},
-
-{0x91, 1,{0x04}},
-
-{0x92, 1,{0x3F}},
-
-{0x93, 1,{0x3F}},
-
-{0x94, 1,{0x3F}},
-
-{0x95, 1,{0x3F}},
-
-{0x96, 1,{0x05}},
-
-{0x97, 1,{0x01}},
-
-{0x98, 1,{0x3F}},
-
-{0x99, 1,{0x3F}},
-
-{0x9A, 1,{0x3F}},
-
-{0x9B, 1,{0x3F}},
-
-{0x9C, 1,{0x3F}},
-
-{0x9D, 1,{0x3F}},
-
-{0x9E, 1,{0x3F}},
-
-{0x9F, 1,{0x3F}},
-
-{0xA0, 1,{0x3F}},
-
-{0xA2, 1,{0x3F}},
-
-{0xA3, 1,{0x3F}},
-
-{0xA4, 1,{0x3F}},
-
-{0xA5, 1,{0x09}},
-
-{0xA6, 1,{0x0B}},
-
-{0xA7, 1,{0x0D}},
-
-{0xA9, 1,{0x0F}},
-
-{0xAA, 1,{0x03}},
-
-{0xAB, 1,{0x07}},
-
-{0xAC, 1,{0x01}},
-
-{0xAD, 1,{0x05}},
-
-{0xAE, 1,{0x0D}},
-
-{0xAF, 1,{0x0F}},
-
-{0xB0, 1,{0x09}},
-
-{0xB1, 1,{0x0B}},
-
-{0xB2, 1,{0x3F}},
-
-{0xB3, 1,{0x3F}},
-
-{0xB4, 1,{0x3F}},
-
-{0xB5, 1,{0x3F}},
-
-{0xB6, 1,{0x3F}},
-
-{0xB7, 1,{0x3F}},
-
-{0xB8, 1,{0x3F}},
-
-{0xB9, 1,{0x3F}},
-
-{0xBA, 1,{0x3F}},
-
-{0xBB, 1,{0x3F}},
-
-{0xBC, 1,{0x3F}},
-
-{0xBD, 1,{0x3F}},
-
-{0xBE, 1,{0x07}},
-
-{0xBF, 1,{0x03}},
-
-{0xC0, 1,{0x3F}},
-
-{0xC1, 1,{0x3F}},
-
-{0xC2, 1,{0x3F}},
-
-{0xC3, 1,{0x3F}},
-
-{0xC4, 1,{0x02}},
-
-{0xC5, 1,{0x06}},
-
-{0xC6, 1,{0x3F}},
-
-{0xC7, 1,{0x3F}},
-
-{0xC8, 1,{0x3F}},
-
-{0xC9, 1,{0x3F}},
-
-{0xCA, 1,{0x3F}},
-
-{0xCB, 1,{0x3F}},
-
-{0xCC, 1,{0x3F}},
-
-{0xCD, 1,{0x3F}},
-
-{0xCE, 1,{0x3F}},
-
-{0xCF, 1,{0x3F}},
-
-{0xD0, 1,{0x3F}},
-
-{0xD1, 1,{0x3F}},
-
-{0xD2, 1,{0x0A}},
-
-{0xD3, 1,{0x08}},
-
-{0xD4, 1,{0x0E}},
-
-{0xD5, 1,{0x0C}},
-
-{0xD6, 1,{0x04}},
-
-{0xD7, 1,{0x00}},
-
-{0xDC, 1,{0x02}},
-
-{0xDE, 1,{0x10}},
-
-{0xFE, 1,{0x0E}},
-
-{0x01, 1,{0x75}},
-
-{0xFE, 1,{0x04}},
-
-{0x60, 1,{0x00}},
-
-{0x61, 1,{0x0A}},
-
-{0x62, 1,{0x10}},
-
-{0x63, 1,{0x0E}},
-
-{0x64, 1,{0x07}},
-
-{0x65, 1,{0x14}},
-
-{0x66, 1,{0x0F}},
-
-{0x67, 1,{0x0B}},
-
-{0x68, 1,{0x16}},
-
-{0x69, 1,{0x0C}},
-
-{0x6A, 1,{0x0F}},
-
-{0x6B, 1,{0x08}},
-
-{0x6C, 1,{0x0F}},
-
-{0x6D, 1,{0x0E}},
-
-{0x6E, 1,{0x09}},
-
-{0x6F, 1,{0x00}},
-
-{0x70, 1,{0x00}},
-
-{0x71, 1,{0x0A}},
-
-{0x72, 1,{0x10}},
-
-{0x73, 1,{0x0E}},
-
-{0x74, 1,{0x07}},
-
-{0x75, 1,{0x14}},
-
-{0x76, 1,{0x0F}},
-
-{0x77, 1,{0x0B}},
-
-{0x78, 1,{0x16}},
-
-{0x79, 1,{0x0C}},
-
-{0x7A, 1,{0x0F}},
-
-{0x7B, 1,{0x08}},
-
-{0x7C, 1,{0x0F}},
-
-{0x7D, 1,{0x0E}},
-
-{0x7E, 1,{0x09}},
-
-{0x7F, 1,{0x00}},
-
-{0xFE, 1,{0x00}},
-
-{0x58, 1,{0xA9}},//CE ON
-    
+//RM38200+HSD5.94 YKL CODE
+{0xfe, 1, {0x01}},
+{0x24, 1, {0xc0}},
+{0x25, 1, {0x53}},
+{0x26, 1, {0x00}},
+{0x2b, 1, {0xe5}},
+{0x27, 1, {0x0a}},
+{0x29, 1, {0x0a}},
+{0x2f, 1, {0x44}},
+{0x34, 1, {0x55}},
+{0x1b, 1, {0x00}},
+{0x12, 1, {0x08}},
+{0x46, 1, {0x86}},
+{0x52, 1, {0xa0}},
+{0x53, 1, {0x00}},
+{0x54, 1, {0xa0}},
+{0x55, 1, {0x00}},
+{0x5f, 1, {0x12}},
+{0xfe, 1, {0x03}},
+{0x0, 1, {0x05}},
+{0x1, 1, {0x16}},
+{0x2, 1, {0x01}},
+{0x3, 1, {0x08}},
+{0x4, 1, {0x00}},
+{0x5, 1, {0x00}},
+{0x6, 1, {0x50}},
+{0x7, 1, {0x00}},
+{0x8, 1, {0x00}},
+{0x9, 1, {0x00}},
+{0xa, 1, {0x00}},
+{0xb, 1, {0x00}},
+{0xc, 1, {0x00}},
+{0xd, 1, {0x00}},
+{0xe, 1, {0x05}},
+{0xf, 1, {0x06}},
+{0x10, 1, {0x07}},
+{0x11, 1, {0x08}},
+{0x12, 1, {0x00}},
+{0x13, 1, {0x40}},
+{0x14, 1, {0x00}},
+{0x15, 1, {0xc5}},
+{0x16, 1, {0x08}},
+{0x17, 1, {0x09}},
+{0x18, 1, {0x0a}},
+{0x19, 1, {0x0b}},
+{0x1a, 1, {0x0c}},
+{0x1b, 1, {0x00}},
+{0x1c, 1, {0x40}},
+{0x1d, 1, {0x00}},
+{0x1e, 1, {0x85}},
+{0x1f, 1, {0x08}},
+{0x20, 1, {0x00}},
+{0x21, 1, {0x00}},
+{0x22, 1, {0x05}},
+{0x23, 1, {0x04}},
+{0x24, 1, {0x06}},
+{0x25, 1, {0x2d}},
+{0x26, 1, {0x00}},
+{0x27, 1, {0x08}},
+{0x28, 1, {0x0a}},
+{0x29, 1, {0x2d}},
+{0x2a, 1, {0x00}},
+{0x2b, 1, {0x00}},
+{0x2d, 1, {0x00}},
+{0x2f, 1, {0x00}},
+{0x30, 1, {0x00}},
+{0x31, 1, {0x00}},
+{0x32, 1, {0x00}},
+{0x33, 1, {0x00}},
+{0x34, 1, {0x00}},
 {0x35, 1, {0x00}},
-
-   
-{0x11, 1, {0x00}},
-{REGFLAG_DELAY, 120, {}},
-
-  // Display ON
-{0x29, 1, {0x00}},
-{REGFLAG_DELAY, 50, {}},
-
-{REGFLAG_END_OF_TABLE, 0x00, {}}
+{0x36, 1, {0x00}},
+{0x37, 1, {0x00}},
+{0x38, 1, {0x00}},
+{0x39, 1, {0x00}},
+{0x3a, 1, {0x00}},
+{0x3b, 1, {0x00}},
+{0x3d, 1, {0x00}},
+{0x3f, 1, {0x00}},
+{0x40, 1, {0x00}},
+{0x41, 1, {0x00}},
+{0x42, 1, {0x00}},
+{0x43, 1, {0x00}},
+{0x44, 1, {0x00}},
+{0x45, 1, {0x00}},
+{0x46, 1, {0x00}},
+{0x47, 1, {0x00}},
+{0x48, 1, {0x00}},
+{0x49, 1, {0x00}},
+{0x4a, 1, {0x00}},
+{0x4b, 1, {0x00}},
+{0x4c, 1, {0x00}},
+{0x4d, 1, {0x00}},
+{0x4e, 1, {0x00}},
+{0x4f, 1, {0x00}},
+{0x50, 1, {0x00}},
+{0x51, 1, {0x00}},
+{0x52, 1, {0x00}},
+{0x53, 1, {0x00}},
+{0x54, 1, {0x00}},
+{0x55, 1, {0x00}},
+{0x56, 1, {0x00}},
+{0x58, 1, {0x00}},
+{0x59, 1, {0x00}},
+{0x5a, 1, {0x00}},
+{0x5b, 1, {0x00}},
+{0x5c, 1, {0x00}},
+{0x5d, 1, {0x00}},
+{0x5e, 1, {0x00}},
+{0x5f, 1, {0x00}},
+{0x60, 1, {0x00}},
+{0x61, 1, {0x00}},
+{0x62, 1, {0x00}},
+{0x63, 1, {0x00}},
+{0x64, 1, {0x00}},
+{0x65, 1, {0x00}},
+{0x66, 1, {0x00}},
+{0x67, 1, {0x00}},
+{0x68, 1, {0x00}},
+{0x69, 1, {0x00}},
+{0x6a, 1, {0x00}},
+{0x6b, 1, {0x00}},
+{0x6c, 1, {0x00}},
+{0x6d, 1, {0x00}},
+{0x6e, 1, {0x00}},
+{0x6f, 1, {0x00}},
+{0x70, 1, {0x00}},
+{0x71, 1, {0x00}},
+{0x72, 1, {0x00}},
+{0x73, 1, {0x00}},
+{0x74, 1, {0x01}},
+{0x75, 1, {0x01}},
+{0x76, 1, {0x01}},
+{0x77, 1, {0x01}},
+{0x78, 1, {0x01}},
+{0x79, 1, {0x01}},
+{0x7a, 1, {0x00}},
+{0x7b, 1, {0x00}},
+{0x7c, 1, {0x00}},
+{0x7d, 1, {0x00}},
+{0x7e, 1, {0x01}},
+{0x7f, 1, {0x09}},
+{0x80, 1, {0x0b}},
+{0x81, 1, {0x0d}},
+{0x82, 1, {0x0f}},
+{0x83, 1, {0x3f}},
+{0x84, 1, {0x3f}},
+{0x85, 1, {0x1c}},
+{0x86, 1, {0x1c}},
+{0x87, 1, {0x3f}},
+{0x88, 1, {0x3f}},
+{0x89, 1, {0x3f}},
+{0x8a, 1, {0x3f}},
+{0x8b, 1, {0x3f}},
+{0x8c, 1, {0x3f}},
+{0x8d, 1, {0x3f}},
+{0x8e, 1, {0x3f}},
+{0x8f, 1, {0x3f}},
+{0x90, 1, {0x3f}},
+{0x91, 1, {0x1d}},
+{0x92, 1, {0x1c}},
+{0x93, 1, {0x03}},
+{0x94, 1, {0x02}},
+{0x95, 1, {0x1c}},
+{0x96, 1, {0x1d}},
+{0x97, 1, {0x3f}},
+{0x98, 1, {0x3f}},
+{0x99, 1, {0x3f}},
+{0x9a, 1, {0x3f}},
+{0x9b, 1, {0x3f}},
+{0x9c, 1, {0x3f}},
+{0x9d, 1, {0x3f}},
+{0x9e, 1, {0x3f}},
+{0x9f, 1, {0x3f}},
+{0xa0, 1, {0x3f}},
+{0xa2, 1, {0x1c}},
+{0xa3, 1, {0x1c}},
+{0xa4, 1, {0x3f}},
+{0xa5, 1, {0x3f}},
+{0xa6, 1, {0x0e}},
+{0xa7, 1, {0x0c}},
+{0xa9, 1, {0x0a}},
+{0xaa, 1, {0x08}},
+{0xab, 1, {0x00}},
+{0xac, 1, {0x02}},
+{0xad, 1, {0x0e}},
+{0xae, 1, {0x0c}},
+{0xaf, 1, {0x0a}},
+{0xb0, 1, {0x08}},
+{0xb1, 1, {0x3f}},
+{0xb2, 1, {0x3f}},
+{0xb3, 1, {0x1c}},
+{0xb4, 1, {0x1c}},
+{0xb5, 1, {0x3f}},
+{0xb6, 1, {0x3f}},
+{0xb7, 1, {0x3f}},
+{0xb8, 1, {0x3f}},
+{0xb9, 1, {0x3f}},
+{0xba, 1, {0x3f}},
+{0xbb, 1, {0x3f}},
+{0xbc, 1, {0x3f}},
+{0xbd, 1, {0x3f}},
+{0xbe, 1, {0x3f}},
+{0xbf, 1, {0x1c}},
+{0xc0, 1, {0x1d}},
+{0xc1, 1, {0x00}},
+{0xc2, 1, {0x01}},
+{0xc3, 1, {0x1d}},
+{0xc4, 1, {0x1c}},
+{0xc5, 1, {0x3f}},
+{0xc6, 1, {0x3f}},
+{0xc7, 1, {0x3f}},
+{0xc8, 1, {0x3f}},
+{0xc9, 1, {0x3f}},
+{0xca, 1, {0x3f}},
+{0xcb, 1, {0x3f}},
+{0xcc, 1, {0x3f}},
+{0xcd, 1, {0x3f}},
+{0xce, 1, {0x3f}},
+{0xcf, 1, {0x1c}},
+{0xd0, 1, {0x1c}},
+{0xd1, 1, {0x3f}},
+{0xd2, 1, {0x3f}},
+{0xd3, 1, {0x09}},
+{0xd4, 1, {0x0b}},
+{0xd5, 1, {0x0d}},
+{0xd6, 1, {0x0f}},
+{0xd7, 1, {0x03}},
+{0xdf, 1, {0x00}},
+{0xdc, 1, {0x02}},
+{0xde, 1, {0x08}},
+{0xfe, 1, {0x0e}},
+{0x1, 1, {0x75}},
+{0xfe, 1, {0x0c}},
+{0x8, 1, {0x06}},
+{0x9, 1, {0x06}},
+{0xfe, 1, {0x04}},
+{0x60, 1, {0x00}},
+{0x61, 1, {0x0c}},
+{0x62, 1, {0x12}},
+{0x63, 1, {0x0e}},
+{0x64, 1, {0x07}},
+{0x65, 1, {0x13}},
+{0x66, 1, {0x0f}},
+{0x67, 1, {0x0b}},
+{0x68, 1, {0x16}},
+{0x69, 1, {0x0c}},
+{0x6a, 1, {0x0e}},
+{0x6b, 1, {0x08}},
+{0x6c, 1, {0x0f}},
+{0x6d, 1, {0x0b}},
+{0x6e, 1, {0x04}},
+{0x6f, 1, {0x00}},
+{0x70, 1, {0x00}},
+{0x71, 1, {0x0c}},
+{0x72, 1, {0x12}},
+{0x73, 1, {0x0e}},
+{0x74, 1, {0x07}},
+{0x75, 1, {0x13}},
+{0x76, 1, {0x0f}},
+{0x77, 1, {0x0b}},
+{0x78, 1, {0x16}},
+{0x79, 1, {0x0c}},
+{0x7a, 1, {0x0e}},
+{0x7b, 1, {0x08}},
+{0x7c, 1, {0x0f}},
+{0x7d, 1, {0x0b}},
+{0x7e, 1, {0x04}},
+{0x7f, 1, {0x00}},
+{0xfe, 1, {0x00}},
+{0x58, 1, {0xad}},
+{0x35, 0, {}},
+{0x11, 0, {}},
+		{REGFLAG_DELAY, 120, {}},
+{0x29, 0, {}},
+		{REGFLAG_DELAY, 20, {}},
+
+		{REGFLAG_END_OF_TABLE, 0x00, {}}
 };
 
 
 static struct LCM_setting_table lcm_sleep_out_setting[] = {
 	// Sleep Out
-	{0x11, 1, {0x00}},
+	{0x11, 0, {0x00}},
 	{REGFLAG_DELAY, 120, {}},
 
 	// Display ON
-	{0x29, 1, {0x00}},
-	{REGFLAG_DELAY, 10, {}},
+	{0x29, 0, {0x00}},
+	{REGFLAG_DELAY, 50, {}},
 
 	{REGFLAG_END_OF_TABLE, 0x00, {}}
 };
@@ -743,20 +455,23 @@ static struct LCM_setting_table lcm_sleep_out_setting[] = {
 
 static struct LCM_setting_table lcm_sleep_in_setting[] = {
 	// Display off sequence
-	{0x01, 1, {0x00}},
-	{REGFLAG_DELAY, 50, {}},
 	
-	{0x28, 1, {0x00}},
+	{0x28, 0, {0x00}},
 	{REGFLAG_DELAY, 50, {}},
 
 	// Sleep Mode On
 	{0x10, 1, {0x00}},
-	{REGFLAG_DELAY, 50, {}},
+	{REGFLAG_DELAY, 150, {}},
+
+	{0x4f, 0, {0x01}},
+	{REGFLAG_DELAY, 150, {}},
+	
 
 	{REGFLAG_END_OF_TABLE, 0x00, {}}
 };
 
-static void push_table(struct LCM_setting_table *table, unsigned int count,	unsigned char force_update)
+static void push_table(struct LCM_setting_table *table, unsigned int count,
+		unsigned char force_update)
 {
 	unsigned int i;
 
@@ -775,7 +490,8 @@ static void push_table(struct LCM_setting_table *table, unsigned int count,	unsi
 			break;
 
 		default:
-			dsi_set_cmdq_V2(cmd, table[i].count,	table[i].para_list, force_update);
+			dsi_set_cmdq_V2(cmd, table[i].count,
+					table[i].para_list, force_update);
 		}
 	}
 
@@ -802,10 +518,14 @@ static void lcm_get_params(LCM_PARAMS * params)
 	params->height = FRAME_HEIGHT;
 
 	// enable tearing-free
-	params->dbi.te_mode = LCM_DBI_TE_MODE_DISABLED;
+	params->dbi.te_mode = LCM_DBI_TE_MODE_VSYNC_ONLY;//LCM_DBI_TE_MODE_DISABLED;
 	params->dbi.te_edge_polarity = LCM_POLARITY_RISING;
 
-    params->dsi.mode   = SYNC_EVENT_VDO_MODE;
+#if (LCM_DSI_CMD_MODE)
+	params->dsi.mode = CMD_MODE;
+#else
+	params->dsi.mode   = SYNC_PULSE_VDO_MODE;//SYNC_EVENT_VDO_MODE;//BURST_VDO_MODE;////
+#endif
 
 	// DSI
 	/* Command mode setting */
@@ -818,23 +538,43 @@ static void lcm_get_params(LCM_PARAMS * params)
 	params->dsi.data_format.format      = LCM_DSI_FORMAT_RGB888;
 	
 	
-    params->dsi.packet_size=256;
-    // Video mode setting       
-    params->dsi.intermediat_buffer_num = 2;
-    params->dsi.PS=LCM_PACKED_PS_24BIT_RGB888;
-    params->dsi.vertical_sync_active                = 4;//2;//
-    params->dsi.vertical_backporch                  = 16;//38;//
-    params->dsi.vertical_frontporch                 = 20;//40;//
-    params->dsi.vertical_active_line                = FRAME_HEIGHT; 
-    params->dsi.horizontal_sync_active              = 10;//24;//
-    params->dsi.horizontal_backporch                =75;//75;//
-    params->dsi.horizontal_frontporch               = 64;//75;//
-    params->dsi.horizontal_blanking_pixel              = 60;
-    params->dsi.horizontal_active_pixel            = FRAME_WIDTH;
-    // Bit rate calculation
-
-    params->dsi.PLL_CLOCK=220;//230
-   // params->dsi.ssc_disable=1;
+	params->dsi.PS=LCM_PACKED_PS_24BIT_RGB888;
+	
+#if (LCM_DSI_CMD_MODE)
+	params->dsi.intermediat_buffer_num = 0;//because DSI/DPI HW design change, this parameters should be 0 when video mode in MT658X; or memory leakage
+	params->dsi.word_count=FRAME_WIDTH*3;	//DSI CMD mode need set these two bellow params, different to 6577
+#else
+	params->dsi.intermediat_buffer_num = 0;	//because DSI/DPI HW design change, this parameters should be 0 when video mode in MT658X; or memory leakage
+#endif
+
+	// Video mode setting
+	params->dsi.packet_size=256;
+
+	params->dsi.vertical_sync_active				=  2;//2
+	params->dsi.vertical_backporch					= 14;//50;
+	params->dsi.vertical_frontporch					= 16;//50;
+	params->dsi.vertical_active_line				= FRAME_HEIGHT; 
+
+	params->dsi.horizontal_sync_active				= 8;//10
+	params->dsi.horizontal_backporch				= 80;//34; 
+	params->dsi.horizontal_frontporch				= 80;//24;
+	params->dsi.horizontal_active_pixel				= FRAME_WIDTH;
+
+	// Bit rate calculation
+//params->dsi.ssc_disable = 1;
+	//1 Every lane speed
+params->dsi.PLL_CLOCK=210;//195
+
+//ESD
+    params->dsi.esd_check_enable            = 1;
+    params->dsi.customization_esd_check_enable  = 1;
+    params->dsi.lcm_esd_check_table[0].cmd          = 0x0a;
+    params->dsi.lcm_esd_check_table[0].count        = 1;
+    params->dsi.lcm_esd_check_table[0].para_list[0] = 0x9c;
+
+    params->dsi.noncont_clock = 1;
+    params->dsi.noncont_clock_period = 1;
+
 }
 
 static void lcm_init(void)
@@ -852,41 +592,28 @@ static void lcm_init(void)
 
 static void lcm_suspend(void)
 {
- 
-     push_table(lcm_sleep_in_setting,sizeof(lcm_sleep_in_setting) /sizeof(struct LCM_setting_table), 1);
-
-   SET_RESET_PIN(0);
-     MDELAY(50);
-	 
-
+	unsigned int array[16];
+	array[0] = 0x00FE1500;
+	dsi_set_cmdq(array, 1, 1);
+	MDELAY(50);
+	array[0] = 0x00011500;
+	dsi_set_cmdq(array, 1, 1);
+	MDELAY(50);
+	array[0] = 0x00280500;
+	dsi_set_cmdq(array, 1, 1);
+	MDELAY(50);
+	array[0] = 0x00100500;
+	dsi_set_cmdq(array, 1, 1);
+	MDELAY(50);
+	array[0] = 0x014F1500;
+	dsi_set_cmdq(array, 1, 1);
+	MDELAY(50);
 }
 
 
 static void lcm_resume(void)
-{
-    //unsigned int id;
-	//unsigned char buffer[5];
-	//unsigned int array[5];
-	//lcm_compare_id();
-//	push_table(lcm_sleep_out_setting,sizeof(lcm_sleep_out_setting) /sizeof(struct LCM_setting_table), 1);
+{   
 	lcm_init();
-			
-/*array[0] = 0x00063902;// read id return two byte,version and id
-	array[1] = 0x52AA55F0;
-	array[2] = 0x00000108;
-	dsi_set_cmdq(array, 3, 1);
-	MDELAY(10);
-	
-	array[0] = 0x00023700;// read id return two byte,version and id
-	dsi_set_cmdq(array, 1, 1);
-
-	read_reg_v2(0xc5, buffer, 2);
-	id = ((buffer[0] << 8) | buffer[1]);
-#if defined(BUILD_LK)
-printf("%s, [rm68191_ctc50_jhzt]  buffer[0] = [0x%d] buffer[2] = [0x%d] ID = [0x%d]\n",__func__, buffer[0], buffer[1], id);
-#else
-printk("%s, [rm68191_ctc50_jhzt]  buffer[0] = [0x%d] buffer[2] = [0x%d] ID = [0x%d]\n",__func__, buffer[0], buffer[1], id);
-#endif*/
 }
 
 
@@ -919,45 +646,45 @@ static void lcm_update(unsigned int x, unsigned int y,
 	data_array[5] = (y1_LSB);
 	data_array[6] = 0x002c3909;
 
-	dsi_set_cmdq(&data_array, 7, 0);
+	dsi_set_cmdq(data_array, 7, 0);
 
 }
 
 
 static unsigned int lcm_compare_id(void)
 {
-	int array[4];
-	char buffer[5];
-	char id_high=0;
-	char id_low=0;
-	int id1=0;
-	int id2=0;
-
-	SET_RESET_PIN(1);
-	MDELAY(10);
-	SET_RESET_PIN(0);
-	MDELAY(10);
-	SET_RESET_PIN(1);
-	MDELAY(120);
-	
-	array[0]=0x01FE1500;
-	dsi_set_cmdq(&array,1, 1);
-	
-	array[0] = 0x00013700;
-	dsi_set_cmdq(array, 1, 1);
-	read_reg_v2(0xde, buffer, 1);
-
-	id_high = buffer[0];
-	read_reg_v2(0xdf, buffer, 1);
-	id_low = buffer[0];
-	id1 = (id_high<<8) | id_low;
-
-	#if defined(BUILD_LK)
+		int array[4];
+		char buffer[5];
+		char id_high=0;
+		char id_low=0;
+		int id1=0;
+		int id2=0;
+
+		SET_RESET_PIN(1);
+		MDELAY(10);
+		SET_RESET_PIN(0);
+		MDELAY(10);
+		SET_RESET_PIN(1);
+		MDELAY(200);
+		array[0]=0x01FE1500;
+		dsi_set_cmdq(array,1, 1);
+
+		array[0] = 0x00013700;
+		dsi_set_cmdq(array, 1, 1);
+		read_reg_v2(0xde, buffer, 1);
+
+		id_high = buffer[0];
+		read_reg_v2(0xdf, buffer, 1);
+		id_low = buffer[0];
+		id1 = (id_high<<8) | id_low;
+
+		#if defined(BUILD_LK)
 		printf("rm68200a %s id1 = 0x%04x, id2 = 0x%04x\n", __func__, id1,id2);
-	#else
+		#else
 		printk("rm68200a %s id1 = 0x%04x, id2 = 0x%04x\n", __func__, id1,id2);
-	#endif
-	return (0x6820 == id1)?1:0;
+		#endif
+		return (LCM_RM68200_ID == id1)?1:0;
+
 }
 //no use
 static unsigned int lcm_esd_recover(void)
@@ -986,7 +713,7 @@ static unsigned int lcm_esd_recover(void)
     #endif
    
    data_array1[0]= 0x00320500;
-   dsi_set_cmdq(&data_array1, 1, 1);
+   dsi_set_cmdq(data_array1, 1, 1);
    MDELAY(50);
 
     return 1;
@@ -1021,6 +748,7 @@ static unsigned int lcm_esd_check(void)
         }
 #endif
 }
+
 // ---------------------------------------------------------------------------
 //  Get LCM Driver Hooks
 // ---------------------------------------------------------------------------
diff --git a/include/generated/compile.h b/include/generated/compile.h
index 7e86526..979a02f 100644
--- a/include/generated/compile.h
+++ b/include/generated/compile.h
@@ -1,7 +1,7 @@
-/* This file is auto generated, version 11 */
+/* This file is auto generated, version 12 */
 /* SMP PREEMPT */
 #define UTS_MACHINE "arm64"
-#define UTS_VERSION "#11 SMP PREEMPT Mon May 9 22:10:16 MSK 2016"
+#define UTS_VERSION "#12 SMP PREEMPT Mon May 9 22:11:40 MSK 2016"
 #define LINUX_COMPILE_BY "olegsvs"
 #define LINUX_COMPILE_HOST "olegsvs-develop"
 #define LINUX_COMPILER "gcc version 4.9 20150123 (prerelease) (GCC) "
-- 
2.7.4

